// Generated by DDC, the Dart Development Compiler (to JavaScript).
// Version: 3.3.1 (stable) (Wed Mar 6 13:09:19 2024 +0000) on "macos_arm64"
// Module: packages/leak_tracker/src/leak_tracking/_leak_reporter.dart
// Flags: newRuntimeTypes(true), soundNullSafety(true), enableAsserts(true)
define(['dart_sdk', 'packages/leak_tracker/src/shared/shared_model.dart', 'packages/leak_tracker/src/shared/_util.dart', 'packages/leak_tracker/src/devtools_integration/delivery.dart'], (function load__packages__leak_tracker__src__leak_tracking___leak_reporter_dart(dart_sdk, packages__leak_tracker__src__shared__shared_model$46dart, packages__leak_tracker__src__shared___util$46dart, packages__leak_tracker__src__devtools_integration__delivery$46dart) {
  'use strict';
  const dart_rti = dart_sdk.dart_rti;
  const core = dart_sdk.core;
  const _js_helper = dart_sdk._js_helper;
  const async = dart_sdk.async;
  const _internal = dart_sdk._internal;
  const dart = dart_sdk.dart;
  const dartx = dart_sdk.dartx;
  const shared_model = packages__leak_tracker__src__shared__shared_model$46dart.src__shared__shared_model;
  const _util = packages__leak_tracker__src__shared___util$46dart.src__shared___util;
  const delivery = packages__leak_tracker__src__devtools_integration__delivery$46dart.src__devtools_integration__delivery;
  var _leak_reporter = Object.create(dart.library);
  dart._checkModuleNullSafetyMode(true);
  dart._checkModuleRuntimeTypes(true);
  var T = {
    LeakType: () => (T.LeakType = dart.constFn(dart_rti.findType("leak_tracker__src__shared__shared_model|LeakType")))(),
    int: () => (T.int = dart.constFn(dart_rti.findType("core|int")))(),
    void: () => (T.void = dart.constFn(dart_rti.findType("~")))(),
    TimerToFutureOfvoid: () => (T.TimerToFutureOfvoid = dart.constFn(dart_rti.findType("async|Future<~>(async|Timer)")))(),
    LeakSummary: () => (T.LeakSummary = dart.constFn(dart_rti.findType("leak_tracker__src__shared__shared_model|LeakSummary")))(),
    TimerN: () => (T.TimerN = dart.constFn(dart_rti.findType("async|Timer?")))(),
    VoidToFutureOfLeakSummary: () => (T.VoidToFutureOfLeakSummary = dart.constFn(dart_rti.findType("async|Future<leak_tracker__src__shared__shared_model|LeakSummary>()")))(),
    VoidTovoid: () => (T.VoidTovoid = dart.constFn(dart_rti.findType("~()")))(),
    bool: () => (T.bool = dart.constFn(dart_rti.findType("core|bool")))(),
    DurationN: () => (T.DurationN = dart.constFn(dart_rti.findType("core|Duration?")))(),
    StdoutSummarySinkN: () => (T.StdoutSummarySinkN = dart.constFn(dart_rti.findType("leak_tracker__src__leak_tracking___leak_reporter|StdoutSummarySink?")))(),
    DevToolsSummarySinkN: () => (T.DevToolsSummarySinkN = dart.constFn(dart_rti.findType("leak_tracker__src__leak_tracking___leak_reporter|DevToolsSummarySink?")))(),
    LeakSummaryToNvoid: () => (T.LeakSummaryToNvoid = dart.constFn(dart_rti.findType("~(leak_tracker__src__shared__shared_model|LeakSummary)?")))(),
    LeakProvider: () => (T.LeakProvider = dart.constFn(dart_rti.findType("leak_tracker__src__shared__shared_model|LeakProvider")))(),
    LeakSummaryTovoid: () => (T.LeakSummaryTovoid = dart.constFn(dart_rti.findType("~(leak_tracker__src__shared__shared_model|LeakSummary)")))()
  };
  var G = {
    LinkedMapOfLeakType$int: () => (G.LinkedMapOfLeakType$int = dart.constFn(_js_helper.LinkedMap$(T.LeakType(), T.int())))(),
    EventFromAppOfLeakSummary: () => (G.EventFromAppOfLeakSummary = dart.constFn(delivery.EventFromApp$(T.LeakSummary())))()
  };
  const CT = Object.create({
    _: () => (C, CT)
  });
  var I = [
    "package:leak_tracker/src/leak_tracking/_leak_reporter.dart",
    "dart:async",
    "dart:core",
    "package:leak_tracker/src/shared/shared_model.dart"
  ];
  var checkPeriod$ = dart.privateName(_leak_reporter, "LeakReporter.checkPeriod");
  var stdoutSink$ = dart.privateName(_leak_reporter, "LeakReporter.stdoutSink");
  var devToolsSink$ = dart.privateName(_leak_reporter, "LeakReporter.devToolsSink");
  var onLeaks$ = dart.privateName(_leak_reporter, "LeakReporter.onLeaks");
  var leakProvider$ = dart.privateName(_leak_reporter, "LeakReporter.leakProvider");
  var __LeakReporter__timer = dart.privateName(_leak_reporter, "_#LeakReporter#_timer");
  var __LeakReporter__timer_isSet = dart.privateName(_leak_reporter, "_#LeakReporter#_timer#isSet");
  var _previousResult = dart.privateName(_leak_reporter, "_previousResult");
  var _timer = dart.privateName(_leak_reporter, "_timer");
  _leak_reporter.LeakReporter = class LeakReporter extends core.Object {
    get checkPeriod() {
      return this[checkPeriod$];
    }
    set checkPeriod(value) {
      super.checkPeriod = value;
    }
    get stdoutSink() {
      return this[stdoutSink$];
    }
    set stdoutSink(value) {
      super.stdoutSink = value;
    }
    get devToolsSink() {
      return this[devToolsSink$];
    }
    set devToolsSink(value) {
      super.devToolsSink = value;
    }
    get onLeaks() {
      return this[onLeaks$];
    }
    set onLeaks(value) {
      super.onLeaks = value;
    }
    get leakProvider() {
      return this[leakProvider$];
    }
    set leakProvider(value) {
      super.leakProvider = value;
    }
    static ['_#new#tearOff'](opts) {
      let leakProvider = opts && 'leakProvider' in opts ? opts.leakProvider : null;
      let checkPeriod = opts && 'checkPeriod' in opts ? opts.checkPeriod : null;
      let onLeaks = opts && 'onLeaks' in opts ? opts.onLeaks : null;
      let stdoutSink = opts && 'stdoutSink' in opts ? opts.stdoutSink : null;
      let devToolsSink = opts && 'devToolsSink' in opts ? opts.devToolsSink : null;
      return new _leak_reporter.LeakReporter.new({leakProvider: leakProvider, checkPeriod: checkPeriod, onLeaks: onLeaks, stdoutSink: stdoutSink, devToolsSink: devToolsSink});
    }
    get [_timer]() {
      return this[__LeakReporter__timer_isSet] ? this[__LeakReporter__timer] : dart.throw(new _internal.LateError.fieldNI("_timer"));
    }
    set [_timer](_timer$35param) {
      if (this[__LeakReporter__timer_isSet])
        dart.throw(new _internal.LateError.fieldAI("_timer"));
      else {
        this[__LeakReporter__timer_isSet] = true;
        this[__LeakReporter__timer] = _timer$35param;
      }
    }
    checkLeaks() {
      return async.async(T.LeakSummary(), (function* checkLeaks() {
        let t$360, t$360$, t$360$0;
        let summary = (yield this.leakProvider.leaksSummary());
        if (!summary.matches(this[_previousResult])) {
          t$360 = this.onLeaks;
          t$360 == null ? null : t$360(summary);
          t$360$ = this.stdoutSink;
          t$360$ == null ? null : t$360$.send(summary);
          t$360$0 = this.devToolsSink;
          t$360$0 == null ? null : t$360$0.send(summary);
          this[_previousResult] = summary;
        }
        return summary;
      }).bind(this));
    }
    dispose() {
      let t$360;
      t$360 = this[_timer];
      t$360 == null ? null : t$360.cancel();
    }
  };
  (_leak_reporter.LeakReporter.new = function(opts) {
    let leakProvider = opts && 'leakProvider' in opts ? opts.leakProvider : null;
    let checkPeriod = opts && 'checkPeriod' in opts ? opts.checkPeriod : null;
    let onLeaks = opts && 'onLeaks' in opts ? opts.onLeaks : null;
    let stdoutSink = opts && 'stdoutSink' in opts ? opts.stdoutSink : null;
    let devToolsSink = opts && 'devToolsSink' in opts ? opts.devToolsSink : null;
    this[__LeakReporter__timer] = null;
    this[__LeakReporter__timer_isSet] = false;
    this[_previousResult] = new shared_model.LeakSummary.new(new (G.LinkedMapOfLeakType$int()).new());
    this[leakProvider$] = leakProvider;
    this[checkPeriod$] = checkPeriod;
    this[onLeaks$] = onLeaks;
    this[stdoutSink$] = stdoutSink;
    this[devToolsSink$] = devToolsSink;
    let period = this.checkPeriod;
    this[_timer] = period == null ? null : async.Timer.periodic(period, dart.fn(_ => async.async(T.void(), (function*() {
      return yield this.checkLeaks();
    }).bind(this)), T.TimerToFutureOfvoid()));
  }).prototype = _leak_reporter.LeakReporter.prototype;
  dart.addTypeTests(_leak_reporter.LeakReporter);
  dart.addRtiResources(_leak_reporter.LeakReporter, ["leak_tracker__src__leak_tracking___leak_reporter|LeakReporter"]);
  dart.addTypeCaches(_leak_reporter.LeakReporter);
  dart.setMethodSignature(_leak_reporter.LeakReporter, () => dart.global.Object.setPrototypeOf({
    checkLeaks: T.VoidToFutureOfLeakSummary(),
    dispose: T.VoidTovoid()
  }, dart.getMethods(dart.global.Object.getPrototypeOf(_leak_reporter.LeakReporter))));
  dart.setGetterSignature(_leak_reporter.LeakReporter, () => dart.global.Object.setPrototypeOf({[_timer]: T.TimerN()}, dart.getGetters(dart.global.Object.getPrototypeOf(_leak_reporter.LeakReporter))));
  dart.setSetterSignature(_leak_reporter.LeakReporter, () => dart.global.Object.setPrototypeOf({[_timer]: T.TimerN()}, dart.getSetters(dart.global.Object.getPrototypeOf(_leak_reporter.LeakReporter))));
  dart.setLibraryUri(_leak_reporter.LeakReporter, I[0]);
  dart.setFieldSignature(_leak_reporter.LeakReporter, () => dart.global.Object.setPrototypeOf({
    [__LeakReporter__timer]: {type: T.TimerN(), isConst: false, isFinal: false, libraryUri: I[1]},
    [__LeakReporter__timer_isSet]: {type: T.bool(), isConst: false, isFinal: false, libraryUri: I[2]},
    [_previousResult]: {type: T.LeakSummary(), isConst: false, isFinal: false, libraryUri: I[3]},
    checkPeriod: {type: T.DurationN(), isConst: false, isFinal: true, libraryUri: I[2]},
    stdoutSink: {type: T.StdoutSummarySinkN(), isConst: false, isFinal: true, libraryUri: I[0]},
    devToolsSink: {type: T.DevToolsSummarySinkN(), isConst: false, isFinal: true, libraryUri: I[0]},
    onLeaks: {type: T.LeakSummaryToNvoid(), isConst: false, isFinal: true},
    leakProvider: {type: T.LeakProvider(), isConst: false, isFinal: true, libraryUri: I[3]}
  }, dart.getFields(dart.global.Object.getPrototypeOf(_leak_reporter.LeakReporter))));
  _leak_reporter.StdoutSummarySink = class StdoutSummarySink extends core.Object {
    send(summary) {
      return _util.printToConsole(summary.toMessage());
    }
    static ['_#new#tearOff']() {
      return new _leak_reporter.StdoutSummarySink.new();
    }
  };
  (_leak_reporter.StdoutSummarySink.new = function() {
    ;
  }).prototype = _leak_reporter.StdoutSummarySink.prototype;
  dart.addTypeTests(_leak_reporter.StdoutSummarySink);
  dart.addRtiResources(_leak_reporter.StdoutSummarySink, ["leak_tracker__src__leak_tracking___leak_reporter|StdoutSummarySink"]);
  dart.addTypeCaches(_leak_reporter.StdoutSummarySink);
  dart.setMethodSignature(_leak_reporter.StdoutSummarySink, () => dart.global.Object.setPrototypeOf({send: T.LeakSummaryTovoid()}, dart.getMethods(dart.global.Object.getPrototypeOf(_leak_reporter.StdoutSummarySink))));
  dart.setLibraryUri(_leak_reporter.StdoutSummarySink, I[0]);
  _leak_reporter.DevToolsSummarySink = class DevToolsSummarySink extends core.Object {
    send(summary) {
      return new (G.EventFromAppOfLeakSummary()).new(summary).post();
    }
    static ['_#new#tearOff']() {
      return new _leak_reporter.DevToolsSummarySink.new();
    }
  };
  (_leak_reporter.DevToolsSummarySink.new = function() {
    ;
  }).prototype = _leak_reporter.DevToolsSummarySink.prototype;
  dart.addTypeTests(_leak_reporter.DevToolsSummarySink);
  dart.addRtiResources(_leak_reporter.DevToolsSummarySink, ["leak_tracker__src__leak_tracking___leak_reporter|DevToolsSummarySink"]);
  dart.addTypeCaches(_leak_reporter.DevToolsSummarySink);
  dart.setMethodSignature(_leak_reporter.DevToolsSummarySink, () => dart.global.Object.setPrototypeOf({send: T.LeakSummaryTovoid()}, dart.getMethods(dart.global.Object.getPrototypeOf(_leak_reporter.DevToolsSummarySink))));
  dart.setLibraryUri(_leak_reporter.DevToolsSummarySink, I[0]);
  dart_rti._Universe.addRules(dart.typeUniverse, JSON.parse('{"leak_tracker__src__shared__shared_model|LeakType":{"core|_Enum":[],"core|Enum":[]},"core|_Enum":{"core|Enum":[]},"core|int":{"core|num":[],"Comparable.T":"core|num","core|Comparable":["core|num"]},"core|num":{"Comparable.T":"core|num","core|Comparable":["core|num"]},"core|Comparable":{"Comparable.T":"1"},"async|Future":{"Future.T":"1"},"core|Duration":{"Comparable.T":"core|Duration","core|Comparable":["core|Duration"]}}'));
  dart.trackLibraries("packages/leak_tracker/src/leak_tracking/_leak_reporter.dart", {
    "package:leak_tracker/src/leak_tracking/_leak_reporter.dart": _leak_reporter
  }, {
  }, '{"version":3,"sourceRoot":"","sources":["_leak_reporter.dart"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoCkB;;;;;;IAIS;;;;;;IAIE;;;;;;IAKA;;;;;;IAER;;;;;;;;;;;;;;;AAtBD;IAAM;iBAAN;;;;;;;IAAM;;AAyBM;;AACtB,uBAAU,MAAM,AAAa;AAEnC,aAAK,AAAQ,OAAD,SAAS;AACnB;iCAAS,MAAK,OAAO;AACrB;kCAAY,YAAK,OAAO;AACxB;mCAAc,aAAK,OAAO;AAE1B,kCAAkB,OAAO;;AAE3B,cAAO,QAAO;MAChB;;;;AAGE;6BAAQ;IACV;;;QApDgB;QACA;QACA;QACA;QACA;kCAQE;;IAEN,wBAAkB,iCAAY;IAd1B;IACA;IACA;IACA;IACA;AAER,iBAAS;AACf,mBAAS,AAAO,MAAD,WACT,OACM,qBAAS,MAAM,EAAE,QAAC;AAAY,mBAAM;IAAY;EAC9D;;;;;;;;;;;;;;;;;;;;;;SA8CsB;AAAY,kCAAe,AAAQ,OAAD;IAAa;;;;;;;EACvE;;;;;;;SAGwB;AAAY,YAAA,AAAsB,yCAAT,OAAO;IAAQ;;;;;;;EAChE","file":"../../../../../../../../../packages/leak_tracker/src/leak_tracking/_leak_reporter.dart.lib.js"}');
  // Exports:
  return {
    src__leak_tracking___leak_reporter: _leak_reporter
  };
}));

//# sourceMappingURL=_leak_reporter.dart.lib.js.map
