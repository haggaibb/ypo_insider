// Generated by DDC, the Dart Development Compiler (to JavaScript).
// Version: 3.3.1 (stable) (Wed Mar 6 13:09:19 2024 +0000) on "macos_arm64"
// Module: packages/leak_tracker/src/leak_tracking/_leak_filter.dart
// Flags: newRuntimeTypes(true), soundNullSafety(true), enableAsserts(true)
define(['dart_sdk', 'packages/leak_tracker/src/shared/shared_model.dart'], (function load__packages__leak_tracker__src__leak_tracking___leak_filter_dart(dart_sdk, packages__leak_tracker__src__shared__shared_model$46dart) {
  'use strict';
  const dart_rti = dart_sdk.dart_rti;
  const core = dart_sdk.core;
  const _js_helper = dart_sdk._js_helper;
  const dart = dart_sdk.dart;
  const dartx = dart_sdk.dartx;
  const shared_model = packages__leak_tracker__src__shared__shared_model$46dart.src__shared__shared_model;
  var _leak_filter = Object.create(dart.library);
  var $putIfAbsent = dartx.putIfAbsent;
  var $containsKey = dartx.containsKey;
  var $_get = dartx._get;
  var $update = dartx.update;
  dart._checkModuleNullSafetyMode(true);
  dart._checkModuleRuntimeTypes(true);
  var T = {
    PhaseSettings: () => (T.PhaseSettings = dart.constFn(dart_rti.findType("leak_tracker__src__leak_tracking__primitives__model|PhaseSettings")))(),
    _PhaseLeakFilter: () => (T._PhaseLeakFilter = dart.constFn(dart_rti.findType("leak_tracker__src__leak_tracking___leak_filter|_PhaseLeakFilter")))(),
    VoidTo_PhaseLeakFilter: () => (T.VoidTo_PhaseLeakFilter = dart.constFn(dart_rti.findType("leak_tracker__src__leak_tracking___leak_filter|_PhaseLeakFilter()")))(),
    LeakTypeAndObjectRecordTobool: () => (T.LeakTypeAndObjectRecordTobool = dart.constFn(dart_rti.findType("core|bool(leak_tracker__src__shared__shared_model|LeakType,leak_tracker__src__leak_tracking___object_record|ObjectRecord)")))(),
    MapOfPhaseSettings$_PhaseLeakFilter: () => (T.MapOfPhaseSettings$_PhaseLeakFilter = dart.constFn(dart_rti.findType("core|Map<leak_tracker__src__leak_tracking__primitives__model|PhaseSettings,leak_tracker__src__leak_tracking___leak_filter|_PhaseLeakFilter>")))(),
    RecOfStringAndLeakType: () => (T.RecOfStringAndLeakType = dart.constFn(dart_rti.findType("+(core|String,leak_tracker__src__shared__shared_model|LeakType)")))(),
    int: () => (T.int = dart.constFn(dart_rti.findType("core|int")))(),
    intToint: () => (T.intToint = dart.constFn(dart_rti.findType("core|int(core|int)")))(),
    VoidToint: () => (T.VoidToint = dart.constFn(dart_rti.findType("core|int()")))(),
    LeakTypeAndObjectRecordAndIgnoredLeaksSetTobool: () => (T.LeakTypeAndObjectRecordAndIgnoredLeaksSetTobool = dart.constFn(dart_rti.findType("core|bool(leak_tracker__src__shared__shared_model|LeakType,leak_tracker__src__leak_tracking___object_record|ObjectRecord,leak_tracker__src__leak_tracking__primitives__model|IgnoredLeaksSet)")))(),
    MapOfRecOfStringAndLeakType$int: () => (T.MapOfRecOfStringAndLeakType$int = dart.constFn(dart_rti.findType("core|Map<+(core|String,leak_tracker__src__shared__shared_model|LeakType),core|int>")))()
  };
  var G = {
    LinkedMapOfPhaseSettings$_PhaseLeakFilter: () => (G.LinkedMapOfPhaseSettings$_PhaseLeakFilter = dart.constFn(_js_helper.LinkedMap$(T.PhaseSettings(), T._PhaseLeakFilter())))(),
    LinkedMapOfRecOfStringAndLeakType$int: () => (G.LinkedMapOfRecOfStringAndLeakType$int = dart.constFn(_js_helper.LinkedMap$(T.RecOfStringAndLeakType(), T.int())))()
  };
  const CT = Object.create({
    _: () => (C, CT)
  });
  dart.defineLazy(CT, {
    get C0() {
      return C[0] = dart.const(Object.setPrototypeOf({
        [_Enum__name]: "notDisposed",
        [_Enum_index]: 0
      }, shared_model.LeakType.prototype));
    },
    get C1() {
      return C[1] = dart.const(Object.setPrototypeOf({
        [_Enum__name]: "notGCed",
        [_Enum_index]: 1
      }, shared_model.LeakType.prototype));
    },
    get C2() {
      return C[2] = dart.const(Object.setPrototypeOf({
        [_Enum__name]: "gcedLate",
        [_Enum_index]: 2
      }, shared_model.LeakType.prototype));
    }
  }, false);
  var C = Array(3).fill(void 0);
  var I = [
    "package:leak_tracker/src/leak_tracking/_leak_filter.dart",
    "dart:core",
    "file:///Users/haggaibarel/.pub-cache/hosted/pub.dev/leak_tracker-10.0.0/lib/src/leak_tracking/_leak_filter.dart",
    "package:leak_tracker/src/leak_tracking/primitives/model.dart"
  ];
  var _phases = dart.privateName(_leak_filter, "_phases");
  _leak_filter.LeakFilter = class LeakFilter extends core.Object {
    shouldReport(leakType, record) {
      let filter = this[_phases][$putIfAbsent](record.phase, dart.fn(() => new _leak_filter._PhaseLeakFilter.new(record.phase), T.VoidTo_PhaseLeakFilter()));
      return filter.shouldReport(leakType, record);
    }
    static ['_#new#tearOff']() {
      return new _leak_filter.LeakFilter.new();
    }
  };
  (_leak_filter.LeakFilter.new = function() {
    this[_phases] = new (G.LinkedMapOfPhaseSettings$_PhaseLeakFilter()).new();
    ;
  }).prototype = _leak_filter.LeakFilter.prototype;
  dart.addTypeTests(_leak_filter.LeakFilter);
  dart.addRtiResources(_leak_filter.LeakFilter, ["leak_tracker__src__leak_tracking___leak_filter|LeakFilter"]);
  dart.addTypeCaches(_leak_filter.LeakFilter);
  dart.setMethodSignature(_leak_filter.LeakFilter, () => dart.global.Object.setPrototypeOf({shouldReport: T.LeakTypeAndObjectRecordTobool()}, dart.getMethods(dart.global.Object.getPrototypeOf(_leak_filter.LeakFilter))));
  dart.setLibraryUri(_leak_filter.LeakFilter, I[0]);
  dart.setFieldSignature(_leak_filter.LeakFilter, () => dart.global.Object.setPrototypeOf({[_phases]: {type: T.MapOfPhaseSettings$_PhaseLeakFilter(), isConst: false, isFinal: true, libraryUri: I[1]}}, dart.getFields(dart.global.Object.getPrototypeOf(_leak_filter.LeakFilter))));
  var _count = dart.privateName(_leak_filter, "_count");
  var _shouldReport = dart.privateName(_leak_filter, "_shouldReport");
  var _Enum__name = dart.privateName(core, "_Enum._name");
  var _Enum_index = dart.privateName(core, "_Enum.index");
  _leak_filter._PhaseLeakFilter = class _PhaseLeakFilter extends core.Object {
    static ['_#new#tearOff'](phase) {
      return new _leak_filter._PhaseLeakFilter.new(phase);
    }
    shouldReport(leakType, record) {
      switch (leakType) {
        case C[0] || CT.C0:
          {
            return this[_shouldReport](leakType, record, this.phase.ignoredLeaks.notDisposed);
          }
        case C[1] || CT.C1:
        case C[2] || CT.C2:
          {
            return this[_shouldReport](leakType, record, this.phase.ignoredLeaks.notGCed);
          }
      }
    }
    [_shouldReport](leakType, record, ignoredLeaks) {
      if (!dart.equals(record.phase, this.phase)) dart.assertFailed(null, I[2], 53, 12, "record.phase == phase");
      if (ignoredLeaks.ignoreAll) return false;
      let objectType = dart.toString(record.type);
      if (!ignoredLeaks.byClass[$containsKey](objectType)) return true;
      let allowedCount = ignoredLeaks.byClass[$_get](objectType);
      if (allowedCount == null) return false;
      let actualCount = this[_count][$update](dart.recordLiteral("2;", 2, void 0, [objectType, leakType]), dart.fn(value => value + 1, T.intToint()), {ifAbsent: dart.fn(() => 1, T.VoidToint())});
      return actualCount > dart.notNull(allowedCount);
    }
  };
  (_leak_filter._PhaseLeakFilter.new = function(phase) {
    this[_count] = new (G.LinkedMapOfRecOfStringAndLeakType$int()).new();
    this.phase = phase;
    ;
  }).prototype = _leak_filter._PhaseLeakFilter.prototype;
  dart.addTypeTests(_leak_filter._PhaseLeakFilter);
  dart.addRtiResources(_leak_filter._PhaseLeakFilter, ["leak_tracker__src__leak_tracking___leak_filter|_PhaseLeakFilter"]);
  dart.addTypeCaches(_leak_filter._PhaseLeakFilter);
  dart.setMethodSignature(_leak_filter._PhaseLeakFilter, () => dart.global.Object.setPrototypeOf({
    shouldReport: T.LeakTypeAndObjectRecordTobool(),
    [_shouldReport]: T.LeakTypeAndObjectRecordAndIgnoredLeaksSetTobool()
  }, dart.getMethods(dart.global.Object.getPrototypeOf(_leak_filter._PhaseLeakFilter))));
  dart.setLibraryUri(_leak_filter._PhaseLeakFilter, I[0]);
  dart.setFieldSignature(_leak_filter._PhaseLeakFilter, () => dart.global.Object.setPrototypeOf({
    [_count]: {type: T.MapOfRecOfStringAndLeakType$int(), isConst: false, isFinal: true, libraryUri: I[1]},
    phase: {type: T.PhaseSettings(), isConst: false, isFinal: true, libraryUri: I[3]}
  }, dart.getFields(dart.global.Object.getPrototypeOf(_leak_filter._PhaseLeakFilter))));
  dart.moduleConstCaches.set("packages/leak_tracker/src/leak_tracking/_leak_filter.dart", C);
  dart_rti._Universe.addRules(dart.typeUniverse, JSON.parse('{"leak_tracker__src__shared__shared_model|LeakType":{"core|_Enum":[],"core|Enum":[]},"core|_Enum":{"core|Enum":[]},"core|Map":{"Map.K":"1","Map.V":"2"},"core|String":{"Comparable.T":"core|String","core|Comparable":["core|String"],"core|Pattern":[]},"core|Comparable":{"Comparable.T":"1"},"core|int":{"core|num":[],"Comparable.T":"core|num","core|Comparable":["core|num"]},"core|num":{"Comparable.T":"core|num","core|Comparable":["core|num"]}}'));
  dart.trackLibraries("packages/leak_tracker/src/leak_tracking/_leak_filter.dart", {
    "package:leak_tracker/src/leak_tracking/_leak_filter.dart": _leak_filter
  }, {
  }, '{"version":3,"sourceRoot":"","sources":["_leak_filter.dart"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iBAY6B,UAAuB;AAC1C,mBAAS,AAAQ,4BACrB,AAAO,MAAD,QACN,cAAM,sCAAiB,AAAO,MAAD;AAE/B,YAAO,AAAO,OAAD,cAAc,QAAQ,EAAE,MAAM;IAC7C;;;;;;IAR2C,gBAAU;;EASvD;;;;;;;;;;;;;;;iBAU6B,UAAuB;AAChD,cAAQ,QAAQ;;;AAEZ,kBAAO,qBACL,QAAQ,EACR,MAAM,EACN,AAAM,AAAa;;;;;AAIrB,kBAAO,qBACL,QAAQ,EACR,MAAM,EACN,AAAM,AAAa;;;IAG3B;oBAGW,UACI,QACG;AAEhB,WAAoB,YAAb,AAAO,MAAD,QAAU;AACvB,UAAI,AAAa,YAAD,YAAY,MAAO;AAC7B,uBAAyB,cAAZ,AAAO,MAAD;AACzB,WAAK,AAAa,AAAQ,YAAT,uBAAqB,UAAU,GAAG,MAAO;AACpD,yBAAe,AAAa,AAAO,YAAR,gBAAS,UAAU;AACpD,UAAI,AAAa,YAAD,UAAU,MAAO;AAE3B,wBAAc,AAAO,sBACzB,qCAAC,UAAU,EAAE,QAAQ,IACrB,QAAC,SAAU,AAAM,KAAD,GAAG,6BACT,cAAM;AAGlB,YAAO,AAAY,YAAD,gBAAG,YAAY;IACnC;;gDA5CsB;IAGhB,eAAkC;IAHlB;;EAAM","file":"../../../../../../../../../packages/leak_tracker/src/leak_tracking/_leak_filter.dart.lib.js"}');
  // Exports:
  return {
    src__leak_tracking___leak_filter: _leak_filter
  };
}));

//# sourceMappingURL=_leak_filter.dart.lib.js.map
