// Generated by DDC, the Dart Development Compiler (to JavaScript).
// Version: 3.3.1 (stable) (Wed Mar 6 13:09:19 2024 +0000) on "macos_arm64"
// Module: packages/string_scanner/src/line_scanner.dart
// Flags: newRuntimeTypes(true), soundNullSafety(true), enableAsserts(true)
define(['dart_sdk', 'packages/string_scanner/src/utils.dart'], (function load__packages__string_scanner__src__line_scanner_dart(dart_sdk, packages__string_scanner__src__utils$46dart) {
  'use strict';
  const dart_rti = dart_sdk.dart_rti;
  const core = dart_sdk.core;
  const dart = dart_sdk.dart;
  const dartx = dart_sdk.dartx;
  const utils = packages__string_scanner__src__utils$46dart.src__utils;
  const string_scanner = packages__string_scanner__src__utils$46dart.src__string_scanner;
  var line_scanner = Object.create(dart.library);
  var $substring = dartx.substring;
  var $length = dartx.length;
  var $isEmpty = dartx.isEmpty;
  var $last = dartx.last;
  var $removeLast = dartx.removeLast;
  var $lastIndexOf = dartx.lastIndexOf;
  var $toList = dartx.toList;
  dart._checkModuleNullSafetyMode(true);
  dart._checkModuleRuntimeTypes(true);
  var T = {
    int: () => (T.int = dart.constFn(dart_rti.findType("core|int")))(),
    LineScannerState: () => (T.LineScannerState = dart.constFn(dart_rti.findType("string_scanner__src__line_scanner|LineScannerState")))(),
    bool: () => (T.bool = dart.constFn(dart_rti.findType("core|bool")))(),
    intTovoid: () => (T.intTovoid = dart.constFn(dart_rti.findType("~(core|int)")))(),
    StringToListOfMatch: () => (T.StringToListOfMatch = dart.constFn(dart_rti.findType("core|List<core|Match>(core|String)")))(),
    LineScanner: () => (T.LineScanner = dart.constFn(dart_rti.findType("string_scanner__src__line_scanner|LineScanner")))()
  };
  const CT = Object.create({
    _: () => (C, CT)
  });
  var I = [
    "package:string_scanner/src/line_scanner.dart",
    "dart:core"
  ];
  var _line = dart.privateName(line_scanner, "_line");
  var _column = dart.privateName(line_scanner, "_column");
  var _betweenCRLF = dart.privateName(line_scanner, "_betweenCRLF");
  var _scanner$ = dart.privateName(line_scanner, "_scanner");
  var _newlinesIn = dart.privateName(line_scanner, "_newlinesIn");
  var _adjustLineAndColumn = dart.privateName(line_scanner, "_adjustLineAndColumn");
  line_scanner.LineScanner = class LineScanner extends string_scanner.StringScanner {
    get line() {
      return this[_line];
    }
    get column() {
      return this[_column];
    }
    get state() {
      return new line_scanner.LineScannerState.__(this, this.position, this.line, this.column);
    }
    get [_betweenCRLF]() {
      return this.peekChar(-1) === 13 && this.peekChar() === 10;
    }
    set state(state) {
      if (state[_scanner$] !== this) {
        dart.throw(new core.ArgumentError.new("The given LineScannerState was not returned by this LineScanner."));
      }
      super.position = state.position;
      this[_line] = state.line;
      this[_column] = state.column;
    }
    set position(newPosition) {
      let oldPosition = this.position;
      super.position = newPosition;
      if (newPosition > oldPosition) {
        let newlines = this[_newlinesIn](this.string[$substring](oldPosition, newPosition));
        this[_line] = this[_line] + newlines[$length];
        if (newlines[$isEmpty]) {
          this[_column] = this[_column] + (newPosition - oldPosition);
        } else {
          this[_column] = newPosition - newlines[$last].end;
        }
      } else {
        let newlines = this[_newlinesIn](this.string[$substring](newPosition, oldPosition));
        if (this[_betweenCRLF]) newlines[$removeLast]();
        this[_line] = this[_line] - newlines[$length];
        if (newlines[$isEmpty]) {
          this[_column] = this[_column] - (oldPosition - newPosition);
        } else {
          this[_column] = newPosition - this.string[$lastIndexOf](line_scanner._newlineRegExp, newPosition) - 1;
        }
      }
    }
    get position() {
      return super.position;
    }
    static ['_#new#tearOff'](string, opts) {
      let sourceUrl = opts && 'sourceUrl' in opts ? opts.sourceUrl : null;
      let position = opts && 'position' in opts ? opts.position : null;
      return new line_scanner.LineScanner.new(string, {sourceUrl: sourceUrl, position: position});
    }
    scanChar(character) {
      if (!super.scanChar(character)) return false;
      this[_adjustLineAndColumn](character);
      return true;
    }
    readChar() {
      let character = super.readChar();
      this[_adjustLineAndColumn](character);
      return character;
    }
    [_adjustLineAndColumn](character) {
      if (character === 10 || character === 13 && this.peekChar() !== 10) {
        this[_line] = this[_line] + 1;
        this[_column] = 0;
      } else {
        this[_column] = this[_column] + (utils.inSupplementaryPlane(character) ? 2 : 1);
      }
    }
    scan(pattern) {
      if (!super.scan(pattern)) return false;
      let newlines = this[_newlinesIn](dart.nullCheck(dart.nullCheck(this.lastMatch)._get(0)));
      this[_line] = this[_line] + newlines[$length];
      if (newlines[$isEmpty]) {
        this[_column] = this[_column] + dart.nullCheck(dart.nullCheck(this.lastMatch)._get(0)).length;
      } else {
        this[_column] = dart.nullCheck(dart.nullCheck(this.lastMatch)._get(0)).length - newlines[$last].end;
      }
      return true;
    }
    [_newlinesIn](text) {
      let newlines = line_scanner._newlineRegExp.allMatches(text)[$toList]();
      if (this[_betweenCRLF]) newlines[$removeLast]();
      return newlines;
    }
  };
  (line_scanner.LineScanner.new = function(string, opts) {
    let sourceUrl = opts && 'sourceUrl' in opts ? opts.sourceUrl : null;
    let position = opts && 'position' in opts ? opts.position : null;
    this[_line] = 0;
    this[_column] = 0;
    dart.global.Object.getPrototypeOf(line_scanner.LineScanner).new.call(this, string, {sourceUrl: sourceUrl, position: position});
    ;
  }).prototype = line_scanner.LineScanner.prototype;
  dart.addTypeTests(line_scanner.LineScanner);
  dart.addRtiResources(line_scanner.LineScanner, ["string_scanner__src__line_scanner|LineScanner"]);
  dart.addTypeCaches(line_scanner.LineScanner);
  dart.setMethodSignature(line_scanner.LineScanner, () => dart.global.Object.setPrototypeOf({
    [_adjustLineAndColumn]: T.intTovoid(),
    [_newlinesIn]: T.StringToListOfMatch()
  }, dart.getMethods(dart.global.Object.getPrototypeOf(line_scanner.LineScanner))));
  dart.setGetterSignature(line_scanner.LineScanner, () => dart.global.Object.setPrototypeOf({
    line: T.int(),
    column: T.int(),
    state: T.LineScannerState(),
    [_betweenCRLF]: T.bool()
  }, dart.getGetters(dart.global.Object.getPrototypeOf(line_scanner.LineScanner))));
  dart.setSetterSignature(line_scanner.LineScanner, () => dart.global.Object.setPrototypeOf({state: T.LineScannerState()}, dart.getSetters(dart.global.Object.getPrototypeOf(line_scanner.LineScanner))));
  dart.setLibraryUri(line_scanner.LineScanner, I[0]);
  dart.setFieldSignature(line_scanner.LineScanner, () => dart.global.Object.setPrototypeOf({
    [_line]: {type: T.int(), isConst: false, isFinal: false, libraryUri: I[1]},
    [_column]: {type: T.int(), isConst: false, isFinal: false, libraryUri: I[1]}
  }, dart.getFields(dart.global.Object.getPrototypeOf(line_scanner.LineScanner))));
  var position$ = dart.privateName(line_scanner, "LineScannerState.position");
  var line$ = dart.privateName(line_scanner, "LineScannerState.line");
  var column$ = dart.privateName(line_scanner, "LineScannerState.column");
  line_scanner.LineScannerState = class LineScannerState extends core.Object {
    get position() {
      return this[position$];
    }
    set position(value) {
      super.position = value;
    }
    get line() {
      return this[line$];
    }
    set line(value) {
      super.line = value;
    }
    get column() {
      return this[column$];
    }
    set column(value) {
      super.column = value;
    }
    static ['_#_#tearOff'](_scanner, position, line, column) {
      return new line_scanner.LineScannerState.__(_scanner, position, line, column);
    }
  };
  (line_scanner.LineScannerState.__ = function(_scanner, position, line, column) {
    this[_scanner$] = _scanner;
    this[position$] = position;
    this[line$] = line;
    this[column$] = column;
    ;
  }).prototype = line_scanner.LineScannerState.prototype;
  dart.addTypeTests(line_scanner.LineScannerState);
  dart.addRtiResources(line_scanner.LineScannerState, ["string_scanner__src__line_scanner|LineScannerState"]);
  dart.addTypeCaches(line_scanner.LineScannerState);
  dart.setLibraryUri(line_scanner.LineScannerState, I[0]);
  dart.setFieldSignature(line_scanner.LineScannerState, () => dart.global.Object.setPrototypeOf({
    [_scanner$]: {type: T.LineScanner(), isConst: false, isFinal: true, libraryUri: I[0]},
    position: {type: T.int(), isConst: false, isFinal: true, libraryUri: I[1]},
    line: {type: T.int(), isConst: false, isFinal: true, libraryUri: I[1]},
    column: {type: T.int(), isConst: false, isFinal: true, libraryUri: I[1]}
  }, dart.getFields(dart.global.Object.getPrototypeOf(line_scanner.LineScannerState))));
  dart.defineLazy(line_scanner, {
    /*line_scanner._newlineRegExp*/get _newlineRegExp() {
      return core.RegExp.new("\\r\\n?|\\n");
    }
  }, false);
  dart_rti._Universe.addRules(dart.typeUniverse, JSON.parse('{"core|int":{"core|num":[],"Comparable.T":"core|num","core|Comparable":["core|num"]},"core|num":{"Comparable.T":"core|num","core|Comparable":["core|num"]},"core|Comparable":{"Comparable.T":"1"},"core|List":{"List.E":"1","Iterable.E":"1","core|Iterable":["1"],"_ListIterable.E":"1","core|_ListIterable":["1"],"EfficientLengthIterable.T":"1","_internal|EfficientLengthIterable":["1"],"HideEfficientLengthIterable.T":"1","_internal|HideEfficientLengthIterable":["1"]},"core|Iterable":{"Iterable.E":"1"},"core|_ListIterable":{"_ListIterable.E":"1","EfficientLengthIterable.T":"1","_internal|EfficientLengthIterable":["1"],"HideEfficientLengthIterable.T":"1","_internal|HideEfficientLengthIterable":["1"],"Iterable.E":"1","core|Iterable":["1"]},"_internal|EfficientLengthIterable":{"EfficientLengthIterable.T":"1","Iterable.E":"1","core|Iterable":["1"]},"_internal|HideEfficientLengthIterable":{"HideEfficientLengthIterable.T":"1","Iterable.E":"1","core|Iterable":["1"]},"core|String":{"Comparable.T":"core|String","core|Comparable":["core|String"],"core|Pattern":[]},"string_scanner__src__line_scanner|LineScanner":{"string_scanner__src__string_scanner|StringScanner":[]}}'));
  dart.trackLibraries("packages/string_scanner/src/line_scanner.dart", {
    "package:string_scanner/src/line_scanner.dart": line_scanner
  }, {
  }, '{"version":3,"sourceRoot":"","sources":["line_scanner.dart"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBkB;IAAK;;AAIH;IAAO;;AAWrB,YAAiB,sCAAE,MAAM,eAAU,WAAM;IAAO;;AAI3B,YAAA,AAAa,AAAO,eAAX,CAAC,aAAa,AAAW;IAAM;cAEtC;AACzB,UAAe,AAAM,KAAD,gBAAW;AAC7B,mBAAM;;AAIF,uBAAW,AAAM,KAAD;AACtB,oBAAQ,AAAM,KAAD;AACb,sBAAU,AAAM,KAAD;IACjB;iBAGiB;AACT,wBAAc;AACd,uBAAW,WAAW;AAE5B,UAAI,AAAY,WAAD,GAAG,WAAW;AACrB,uBAAW,kBAAY,AAAO,wBAAU,WAAW,EAAE,WAAW;AACtE,sBAAA,AAAM,cAAG,AAAS,QAAD;AACjB,YAAI,AAAS,QAAD;AACV,0BAAA,AAAQ,iBAAG,AAAY,WAAD,GAAG,WAAW;;AAEpC,0BAAU,AAAY,WAAD,GAAG,AAAS,AAAK,QAAN;;;AAG5B,uBAAW,kBAAY,AAAO,wBAAU,WAAW,EAAE,WAAW;AACtE,YAAI,oBAAc,AAAS,QAAD;AAE1B,sBAAA,AAAM,cAAG,AAAS,QAAD;AACjB,YAAI,AAAS,QAAD;AACV,0BAAA,AAAQ,iBAAG,AAAY,WAAD,GAAG,WAAW;;AAEpC,0BACI,AAAY,AAAkD,WAAnD,GAAG,AAAO,0BAAY,6BAAgB,WAAW,IAAI;;;IAG1E;;;;;;;;;aAKkB;AAChB,WAAW,eAAS,SAAS,GAAG,MAAO;AACvC,iCAAqB,SAAS;AAC9B,YAAO;IACT;;AAIQ,sBAAkB;AACxB,iCAAqB,SAAS;AAC9B,YAAO,UAAS;IAClB;2BAG8B;AAC5B,UAAI,AAAU,SAAD,WAAY,AAAU,SAAD,WAAW;AAC3C,sBAAA,AAAM,cAAG;AACT,wBAAU;;AAEV,wBAAA,AAAQ,iBAAG,2BAAqB,SAAS,IAAI,IAAI;;IAErD;SAGkB;AAChB,WAAW,WAAK,OAAO,GAAG,MAAO;AAE3B,qBAAW,kBAAyB,eAAJ,AAAC,eAAV,qBAAW;AACxC,oBAAA,AAAM,cAAG,AAAS,QAAD;AACjB,UAAI,AAAS,QAAD;AACV,wBAAA,AAAQ,gBAAkB,AAAE,eAAP,AAAC,eAAV,qBAAW;;AAEvB,wBAAyB,AAAE,AAAO,eAAd,AAAC,eAAV,qBAAW,aAAc,AAAS,AAAK,QAAN;;AAG9C,YAAO;IACT;kBAI+B;AACvB,qBAAW,AAAe,AAAiB,uCAAN,IAAI;AAC/C,UAAI,oBAAc,AAAS,QAAD;AAC1B,YAAO,SAAQ;IACjB;;2CA/CkB;QAAe;QAAiB;IA1D9C,cAAQ;IAIR,gBAAU;AAsDd,+EAAkB,MAAM,cAAS,SAAS,YAAQ,QAAQ;;EAAE;;;;;;;;;;;;;;;;;;;;;;;;IAwDlD;;;;;;IAGA;;;;;;IAGA;;;;;;;;;;+CAEc,UAAe,UAAe,MAAW;IAAzC;IAAe;IAAe;IAAW;;EAAO;;;;;;;;;;;;MAhIpE,2BAAc;YAAG,iBAAO","file":"../../../../../../../../packages/string_scanner/src/line_scanner.dart.lib.js"}');
  // Exports:
  return {
    src__line_scanner: line_scanner
  };
}));

//# sourceMappingURL=line_scanner.dart.lib.js.map
